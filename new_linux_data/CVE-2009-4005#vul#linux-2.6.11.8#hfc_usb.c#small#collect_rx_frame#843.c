static void collect_rx_frame(usb_fifo *fifo,__u8 *data,int len,int finish)
{
	hfcusb_data *hfc = fifo->hfc;
	int transp_mode,fifon;

	fifon=fifo->fifonum;
	transp_mode=0;/printk(KERN_INFO "HFC-USB: got %d bytes finish:%d max_size:%d fifo:%d\n",len,finish,fifo->max_size,fifon);
	if(!fifo->skbuff)
	{ allocate sk buffer
		fifo->skbuff=dev_alloc_skb(fifo->max_size + 3);
		if(!fifo->skbuff)
		{
			printk(KERN_INFO "HFC-USB: cannot allocate buffer (dev_alloc_skb) fifo:%d\n",fifon);
			return;
		}
		
	}

	if(len && fifo->skbuff->len+len<fifo->max_size)
	{
		memcpy(skb_put(fifo->skbuff,len),data,len);
	}
	else printk(KERN_INFO "HCF-USB: got frame exceeded fifo->max_size:%d\n",fifo->max_size);
 give transparent data up, when 128 byte are available
	if(transp_mode && fifo->skbuff->len>=128)
	{
		fifo->hif->l1l2(fifo->hif,PH_DATA | INDICATION,fifo->skbuff); buffer was freed from upper layer
		return;
	}
 we have a complete hdlc packet
	if(finish)
	{
		if(!fifo->skbuff->data[fifo->skbuff->len-1])
		{ remove CRC & status


			if(fifon==HFCUSB_PCM_RX) fifo->hif->l1l2(fifo->hif,PH_DATA_E | INDICATION,fifo->skbuff);
			else fifo->hif->l1l2(fifo->hif,PH_DATA | INDICATION,fifo->skbuff);
 buffer was freed from upper layer
		}
		else
		{
			printk(KERN_INFO "HFC-USB: got frame %d bytes but CRC ERROR!!!\n",fifo->skbuff->len);
 clear whole buffer
		}
	}
 LED flashing only in HDLC mode
	if(!transp_mode)
	{
		if(fifon==HFCUSB_B1_RX) handle_led(hfc,LED_B1_DATA);
		if(fifon==HFCUSB_B2_RX) handle_led(hfc,LED_B2_DATA);
	}
}
